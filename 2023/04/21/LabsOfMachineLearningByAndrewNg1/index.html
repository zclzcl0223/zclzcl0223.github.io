<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=[object Object]"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '[object Object]');
</script>
<!-- End Google Analytics -->

  
  <title>Lab: Supervised Machine Learning - Regression and Classification | JourneyToCoding</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="This post records the experimental process of labs of Supervised Machine Learning - Regression and Classification by Andrew Ng and some bugs that may be encountered under Windows.">
<meta property="og:type" content="article">
<meta property="og:title" content="Lab: Supervised Machine Learning - Regression and Classification">
<meta property="og:url" content="https://zclzcl0223.github.io/2023/04/21/LabsOfMachineLearningByAndrewNg1/index.html">
<meta property="og:site_name" content="JourneyToCoding">
<meta property="og:description" content="This post records the experimental process of labs of Supervised Machine Learning - Regression and Classification by Andrew Ng and some bugs that may be encountered under Windows.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zclzcl0223.github.io/2023/04/21/LabsOfMachineLearningByAndrewNg1/1.png">
<meta property="article:published_time" content="2023-04-21T15:35:46.000Z">
<meta property="article:modified_time" content="2023-08-09T05:49:20.000Z">
<meta property="article:author" content="ChaosTsang">
<meta property="article:tag" content="Lab">
<meta property="article:tag" content="Supervised Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zclzcl0223.github.io/2023/04/21/LabsOfMachineLearningByAndrewNg1/1.png">
  
    <link rel="alternate" href="/atom.xml" title="JourneyToCoding" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/%5Bobject%20Object%5D">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">JourneyToCoding</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Code for fun</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/">home</a>
        
          <a class="main-nav-link" href="/about/">about</a>
        
          <a class="main-nav-link" href="/tags/">tags</a>
        
          <a class="main-nav-link" href="/categories/">categories</a>
        
          <a class="main-nav-link" href="/archives/">archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://zclzcl0223.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-LabsOfMachineLearningByAndrewNg1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/04/21/LabsOfMachineLearningByAndrewNg1/" class="article-date">
  <time class="dt-published" datetime="2023-04-21T15:35:46.000Z" itemprop="datePublished">2023-04-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Machine-Learning-by-AndrewNg/">Machine Learning by AndrewNg</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Lab: Supervised Machine Learning - Regression and Classification
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <span id="more"></span>

<h1 id="Optional-labs-W1"><a href="#Optional-labs-W1" class="headerlink" title="Optional labs - W1"></a>Optional labs - W1</h1><h2 id="Lab01-Lab02"><a href="#Lab01-Lab02" class="headerlink" title="Lab01 - Lab02"></a>Lab01 - Lab02</h2><p>Just follow its instructions.</p>
<h2 id="Lab03"><a href="#Lab03" class="headerlink" title="Lab03"></a>Lab03</h2><p>There is a markdown syntax error in <strong>Notation</strong> paragraph:</p>
<p><img src="/2023/04/21/LabsOfMachineLearningByAndrewNg1/1.png" alt="1"></p>
<p>To solve this, turn:</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|: ------------|: ------------------------------------------------------------||</span><br></pre></td></tr></table></figure>
<p>to</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|:---:|:---:|:---:|</span><br></pre></td></tr></table></figure>
<p>In <strong>Tools</strong> paragraph, if you have put <code>deeplearning.mplstyle</code> into the same folder of your labs&#39;file, but code <code>plt.style.use(&#39;./deeplearning.mplstyle&#39;)</code> still can&#39;t run, you should delete <code>./</code> in <code>./deeplearning.mplstyle</code>. If your os is Linux, this problem will not occur.</p>
<h2 id="Lab04"><a href="#Lab04" class="headerlink" title="Lab04"></a>Lab04</h2><p>In <strong>Tools</strong> paragraph, code <code>%matplotlib widget</code> can&#39;t run because of the lack of <strong>ipympl</strong> even though you installed jupyter using anaconda. Maybe the reason is that the version of ipympl is not compatible with jupyter. To solve this, run your anaconda prompt as a administrator and:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge ipympl</span><br></pre></td></tr></table></figure>

<p>The problem of <code>./deeplearning.mplstyle</code> will still occur, modify it as before. In addition, you should also modify the same path in <code>lab_utils_commonpy</code> and <code>lab_utils_uni.py</code>. For the following labs, you should keep doing so once you encounter <code>./deeplearning.mplstyle</code>.</p>
<h2 id="Lab05"><a href="#Lab05" class="headerlink" title="Lab05"></a>Lab05</h2><p>You may run into <code>int</code> overflow when running <code>plt_divergence(p_histm J_hist, x_train, y_train)</code>. Solution:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># in file lab_utils_uni.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># line 300: add np.int64</span></span><br><span class="line">w_array = np.arange(-<span class="number">70000</span>, <span class="number">70000</span>, <span class="number">1000</span>, dtype=np.int64)</span><br><span class="line"><span class="comment"># line 301: add np.int64</span></span><br><span class="line">cost = np.zeros_like(w_array, dtype=np.int64)</span><br><span class="line"><span class="comment"># line 319: add np.int64</span></span><br><span class="line">z=np.zeros_like(tmp_b, dtype=np.int64)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Optional-labs-W2"><a href="#Optional-labs-W2" class="headerlink" title="Optional labs - W2"></a>Optional labs - W2</h1><h2 id="Lab01"><a href="#Lab01" class="headerlink" title="Lab01"></a>Lab01</h2><p>See <a href="/2023/04/22/NumPy/">NumPy</a>.</p>
<h2 id="Lab02"><a href="#Lab02" class="headerlink" title="Lab02"></a>Lab02</h2><p>The same bugs as <a href="#Lab03">Supervised Machine Learning.Optional labs - W1.Lab03</a>.</p>
<h2 id="Lab03-1"><a href="#Lab03-1" class="headerlink" title="Lab03"></a>Lab03</h2><p>The same bugs as <a href="#Lab03">Supervised Machine Learning.Optional labs - W1.Lab03</a>.</p>
<h2 id="Lab04-1"><a href="#Lab04-1" class="headerlink" title="Lab04"></a>Lab04</h2><p>Just follow its instructions.</p>
<h2 id="Lab05-Lab06"><a href="#Lab05-Lab06" class="headerlink" title="Lab05 - Lab06"></a>Lab05 - Lab06</h2><p>See <a href="/2023/04/22/Scikit-learn/">Scikit-learn</a>.</p>
<h1 id="Optional-labs-W3"><a href="#Optional-labs-W3" class="headerlink" title="Optional labs - W3"></a>Optional labs - W3</h1><h2 id="Lab01-Lab09-Soln"><a href="#Lab01-Lab09-Soln" class="headerlink" title="Lab01 - Lab09_Soln"></a>Lab01 - Lab09_Soln</h2><p>Just follow its instructions.</p>
<h2 id="Lab01-user"><a href="#Lab01-user" class="headerlink" title="Lab01_user"></a>Lab01_user</h2><p>Answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-z))</span><br></pre></td></tr></table></figure>

<h2 id="Lab02-user"><a href="#Lab02-user" class="headerlink" title="Lab02_user"></a>Lab02_user</h2><p>Answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x1 = <span class="number">3</span> - x0</span><br></pre></td></tr></table></figure>
<p>Besides, there is a bug in <code>lab_utils.plot_data</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add the following codes after neg = y == 0</span></span><br><span class="line">pos = pos.reshape(-<span class="number">1</span>,)  <span class="comment"># work with 1D or 1D y vectors</span></span><br><span class="line">neg = neg.reshape(-<span class="number">1</span>,)</span><br></pre></td></tr></table></figure>

<h2 id="Lab03-user"><a href="#Lab03-user" class="headerlink" title="Lab03_user"></a>Lab03_user</h2><p>Answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="comment">### START CODE HERE ### </span></span><br><span class="line">    g = sigmoid(X[i] @ w + b)</span><br><span class="line">    cost -= y[i] * np.log(g) + (<span class="number">1</span> - y[i]) * np.log(<span class="number">1</span> - g)</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>@</code> can represent matrix multiplication.</p>
</blockquote>
<h2 id="Lab04-user"><a href="#Lab04-user" class="headerlink" title="Lab04_user"></a>Lab04_user</h2><p>Non-vectorized answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    err = sigmoid(X[i] @ w + b) - y[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        dJdw[j] += err * X[i][j]</span><br><span class="line">    dJdb += err</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>For each example, get its error and apply it to different $w_j$.</p>
</blockquote>
<p>Vectorized answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">z = X @ w + b</span><br><span class="line">g = sigmoid(z)</span><br><span class="line">err = g - y</span><br><span class="line">dJdw = <span class="number">1</span> / m * (np.dot(X.T, err))</span><br><span class="line">dJdb = <span class="number">1</span> / m * (np.<span class="built_in">sum</span>(err))</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Get error of all examples simultaneously.</p>
</blockquote>
<h2 id="Lab05-user"><a href="#Lab05-user" class="headerlink" title="Lab05_user"></a>Lab05_user</h2><p>See <a href="/2023/04/22/Scikit-learn/">Scikit-learn</a>.</p>
<h2 id="Lab06-user"><a href="#Lab06-user" class="headerlink" title="Lab06_user"></a>Lab06_user</h2><p>This lab realize multiclass classification using multiple binary classification models, that is <strong>One Vs All algorithm</strong>. In fact, its core idea is quite simple. For an example with $n$ possible $y$, represent its label using a vector with $n$ binary elements, only one of which is <code>1</code>. Then, we just need to train $n$ binary classification models and choose the biggest prediction of them as $\widehat{y}$.</p>
<p>Answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># step 1</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">w_init = np.zeros((<span class="number">2</span>, <span class="number">1</span>))</span><br><span class="line">b_init = <span class="number">0.</span></span><br><span class="line"><span class="comment"># call gradient descent</span></span><br><span class="line">w_final, b_final,_,_ = gradient_descent(X_train, yc, w_init, b_init, </span><br><span class="line">                                        compute_cost_logistic_matrix,</span><br><span class="line">                                        compute_gradient_logistic_matrix,</span><br><span class="line">                                        predict_logistic_matrix, <span class="number">1e-2</span>, <span class="number">1000</span>)</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># make prediction</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">z_wb = X @ W + b</span><br><span class="line">G = sigmoid(z_wb)</span><br><span class="line">pclass = np.argmax(G, axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Second Test Case</span></span><br><span class="line"><span class="comment"># plot the decison boundary. Pass in our models - the w&#x27;s and b&#x27;s assocated with each model and predict_mc</span></span><br><span class="line">plot_mc_decision_boundary(X_train,<span class="number">3</span>, W_models, b_models, predict_mc)</span><br><span class="line">plt.title(<span class="string">&quot;model decision boundary vs original training data&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add the original data to the decison boundary</span></span><br><span class="line">plot_mc_data(X_train,y_train,[<span class="string">&quot;blob one&quot;</span>, <span class="string">&quot;blob two&quot;</span>, <span class="string">&quot;blob three&quot;</span>], legend=<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="Lab07-user"><a href="#Lab07-user" class="headerlink" title="Lab07_user"></a>Lab07_user</h2><p>Just follow its instructions. However, there is also a bug because of the update of <code>sklearn</code>. We should turn <code>penalty=&#39;none&#39;</code> to <code>penalty=None</code>.</p>
<p><code>map_feature</code> is a very interesting function:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">map_feature</span>(<span class="params">X1, X2, degree</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Feature mapping function to polynomial features    </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    X1 = np.atleast_1d(X1)</span><br><span class="line">    X2 = np.atleast_1d(X2)</span><br><span class="line"></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, degree+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>):</span><br><span class="line">            out.append((X1**(i-j) * (X2**j)))</span><br><span class="line">           </span><br><span class="line">    <span class="keyword">return</span> np.stack(out, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>It produces polynomials of degree up to <code>degree</code> formed by <code>X1</code> and <code>X2</code>. That is, if <code>degree=3</code>:<br>$$(x_1+x_2)+(x_1^2+x_1x_2+x_2^2)+(x_1^3+x_1^2x_2+x_1x_2^2+x_2^3)$$</p>
<h2 id="Lab08-user"><a href="#Lab08-user" class="headerlink" title="Lab08_user"></a>Lab08_user</h2><p>Answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">f_wb = sigmoid(X @ w + b) <span class="comment"># m*1</span></span><br><span class="line">cost += <span class="number">1</span> / m * (np.dot(-y, np.log(f_wb)) - np.dot(<span class="number">1</span> - y, np.log(<span class="number">1</span> - f_wb))) + lambda_ / <span class="number">2</span> * np.<span class="built_in">sum</span>((w**<span class="number">2</span>))</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br></pre></td></tr></table></figure>

<h2 id="Lab09-user"><a href="#Lab09-user" class="headerlink" title="Lab09_user"></a>Lab09_user</h2><p>Answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Looping version</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    err = np.<span class="built_in">sum</span>(sigmoid(X[i] @ w + b) - y[i])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        dJdw[j] += err * X[i][j]</span><br><span class="line">    dJdb += err</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Vectorized version</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">f_wb = sigmoid(X @ w + b) <span class="comment"># m*1</span></span><br><span class="line">err = f_wb - y <span class="comment"># m*1</span></span><br><span class="line">dJdw = <span class="number">1</span> / m * np.dot(X.T, err) + lambda_ * w</span><br><span class="line">dJdb = np.<span class="built_in">sum</span>(err) / m</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br></pre></td></tr></table></figure>

<h1 id="PracticeLab01"><a href="#PracticeLab01" class="headerlink" title="PracticeLab01"></a>PracticeLab01</h1><p>This lab requires us to implement the <code>compute_cost</code> and <code>compute_gradient</code> function of a linear regression model with only one feature. It is quite simple:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># compute_cost</span></span><br><span class="line"><span class="comment">### START CODE HERE ###  </span></span><br><span class="line">cost = <span class="number">1</span> / (<span class="number">2</span> * m) * (w * x + b - y)**<span class="number">2</span> <span class="comment"># m*1</span></span><br><span class="line">total_cost = np.<span class="built_in">sum</span>(cost) </span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># compute_gradient</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">f_wb = w * x + b <span class="comment"># m*1</span></span><br><span class="line">err = f_wb - y <span class="comment"># m*1</span></span><br><span class="line">dj_dw = err.T @ x / m</span><br><span class="line">dj_db = np.<span class="built_in">sum</span>(err) / m</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br></pre></td></tr></table></figure>

<h1 id="PracticeLab02"><a href="#PracticeLab02" class="headerlink" title="PracticeLab02"></a>PracticeLab02</h1><p>This lab requires us to implement a logistic regression model with regularization. It is a bit more complicated than PracticeLab01, but it&#39;s still easy to finish.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sigmoid</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">g = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-z))</span><br><span class="line"><span class="comment">### END SOLUTION ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># compute_cost</span></span><br><span class="line"><span class="comment">### START CODE HERE ###</span></span><br><span class="line">f_wb = sigmoid(X @ w + b) <span class="comment"># m*1</span></span><br><span class="line">total_cost = <span class="number">1</span> / m * (np.dot(-y.T, np.log(f_wb)) - np.dot(<span class="number">1</span> - y.T, np.log(<span class="number">1</span> - f_wb)))</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># compute_gradient</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">f_wb = sigmoid(X @ w + b)</span><br><span class="line">err = f_wb - y</span><br><span class="line">dj_dw = <span class="number">1</span> / m * (X.T @ err)</span><br><span class="line">dj_db = <span class="number">1</span> / m * np.<span class="built_in">sum</span>(err)</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># predict</span></span><br><span class="line"><span class="comment">### START CODE HERE ### </span></span><br><span class="line">y_pred = sigmoid(X @ w + b)</span><br><span class="line">p = <span class="number">0</span> + (y_pred &gt;= <span class="number">0.5</span>)</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># compute_cost_reg</span></span><br><span class="line"><span class="comment">### START CODE HERE ###</span></span><br><span class="line">reg_cost = np.<span class="built_in">sum</span>(w**<span class="number">2</span>)</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># compute_gradient_reg</span></span><br><span class="line"><span class="comment">### START CODE HERE ###     </span></span><br><span class="line">dj_dw += lambda_  / m * w</span><br><span class="line"><span class="comment">### END CODE HERE ###</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://zclzcl0223.github.io/2023/04/21/LabsOfMachineLearningByAndrewNg1/" data-id="clzik0lcf003qv47k97e9g44v" data-title="Lab: Supervised Machine Learning - Regression and Classification" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Lab/" rel="tag">Lab</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Supervised-Learning/" rel="tag">Supervised Learning</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/04/22/NumPy/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          NumPy
        
      </div>
    </a>
  
  
    <a href="/2023/04/19/ReinforcementLearning/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Reinforcement Learning</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Advanced-Model/">Advanced Model</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CS7313-Computational-Complexity/">CS7313: Computational Complexity</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Configuration/">Configuration</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dive-Into-Deep-Learning/">Dive Into Deep Learning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/GNN/">GNN</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel-Method/">Kernel Method</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MATH6005-Matrix-Theory/">MATH6005: Matrix Theory</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning-by-AndrewNg/">Machine Learning by AndrewNg</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/">Paper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming-Language/">Programming Language</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tool/">Tool</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Attention-Mechanism/" rel="tag">Attention Mechanism</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/" rel="tag">CNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Analysis/" rel="tag">Data Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dataset-Distillation/" rel="tag">Dataset Distillation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Decision-Trees/" rel="tag">Decision Trees</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deep-Learning/" rel="tag">Deep Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GCN/" rel="tag">GCN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GNN/" rel="tag">GNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Generative-AI/" rel="tag">Generative AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lab/" rel="tag">Lab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markup-Language/" rel="tag">Markup Language</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/" rel="tag">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Paper/" rel="tag">Paper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RNN/" rel="tag">RNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Recommender-System/" rel="tag">Recommender System</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reinforcement-Learning/" rel="tag">Reinforcement Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SVM/" rel="tag">SVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Supervised-Learning/" rel="tag">Supervised Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Theoretical-Computer-Science/" rel="tag">Theoretical Computer Science</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tool/" rel="tag">Tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unsupervised-Learning/" rel="tag">Unsupervised Learning</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Attention-Mechanism/" style="font-size: 11.82px;">Attention Mechanism</a> <a href="/tags/CNN/" style="font-size: 12.73px;">CNN</a> <a href="/tags/Configuration/" style="font-size: 10px;">Configuration</a> <a href="/tags/Data-Analysis/" style="font-size: 10px;">Data Analysis</a> <a href="/tags/Dataset-Distillation/" style="font-size: 13.64px;">Dataset Distillation</a> <a href="/tags/Decision-Trees/" style="font-size: 10px;">Decision Trees</a> <a href="/tags/Deep-Learning/" style="font-size: 20px;">Deep Learning</a> <a href="/tags/GCN/" style="font-size: 11.82px;">GCN</a> <a href="/tags/GNN/" style="font-size: 15.45px;">GNN</a> <a href="/tags/Generative-AI/" style="font-size: 10.91px;">Generative AI</a> <a href="/tags/Hexo/" style="font-size: 10.91px;">Hexo</a> <a href="/tags/Lab/" style="font-size: 10.91px;">Lab</a> <a href="/tags/Linux/" style="font-size: 16.36px;">Linux</a> <a href="/tags/Machine-Learning/" style="font-size: 17.27px;">Machine Learning</a> <a href="/tags/Markup-Language/" style="font-size: 10px;">Markup Language</a> <a href="/tags/Math/" style="font-size: 19.09px;">Math</a> <a href="/tags/Paper/" style="font-size: 14.55px;">Paper</a> <a href="/tags/Python/" style="font-size: 18.18px;">Python</a> <a href="/tags/RNN/" style="font-size: 10.91px;">RNN</a> <a href="/tags/Recommender-System/" style="font-size: 10.91px;">Recommender System</a> <a href="/tags/Reinforcement-Learning/" style="font-size: 10.91px;">Reinforcement Learning</a> <a href="/tags/SVM/" style="font-size: 10px;">SVM</a> <a href="/tags/Supervised-Learning/" style="font-size: 11.82px;">Supervised Learning</a> <a href="/tags/Theoretical-Computer-Science/" style="font-size: 15.45px;">Theoretical Computer Science</a> <a href="/tags/Tool/" style="font-size: 18.18px;">Tool</a> <a href="/tags/Unsupervised-Learning/" style="font-size: 11.82px;">Unsupervised Learning</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">June 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/06/17/Diffusion/">Diffusion</a>
          </li>
        
          <li>
            <a href="/2024/01/20/VAE/">VAE</a>
          </li>
        
          <li>
            <a href="/2023/12/02/CountingComplexity/">Computational Complexity: Complexity of Counting</a>
          </li>
        
          <li>
            <a href="/2023/11/24/MatrixTheory5/">MatrixTheory: 特殊矩阵与矩阵分解</a>
          </li>
        
          <li>
            <a href="/2023/11/13/RandomizedComputation/">Computational Complexity: Randomized Computation</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 ChaosTsang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/" class="mobile-nav-link">home</a>
  
    <a href="/about/" class="mobile-nav-link">about</a>
  
    <a href="/tags/" class="mobile-nav-link">tags</a>
  
    <a href="/categories/" class="mobile-nav-link">categories</a>
  
    <a href="/archives/" class="mobile-nav-link">archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>





<script src="/js/script.js"></script>





  </div>
</body>
</html>